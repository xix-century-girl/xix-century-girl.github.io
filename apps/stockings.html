<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="../PatternAppTemplate/pattern-app-template.css" />
	</head>
	<body>
		<div id="stockingsApp"></div>
		<script src="../PatternAppTemplate/pattern-app-template.js"></script>
		<script>
			var inputDefinitions = [
				new InputDefinition("pSzerProbki", "Initial sample width"),
				new InputDefinition("pDlProbki", "Initial sample length"),
				new InputDefinition("kSzerProbki", "Final sample width"),
				new InputDefinition("kDlProbki", "Final sample length"),
				new InputDefinition("maxSzerProbki", "Maximal sample width"),
				new InputDefinition("dlGoryStopy", "Upper foot length"),
				new InputDefinition("dlKostkaLydka", "Ankle to calf length"),
				new InputDefinition("dlKolanoPodkolano", "Knee to lower knee length"),
				new InputDefinition("dlKostkaKolano", "Ankle to knee length"),
				new InputDefinition("dlKolanoBrzeg", "Knee to thigh length"),
				new InputDefinition("obPalcow", "Toes circumference"),
				new InputDefinition("obPiety", "Heel circumference"),
				new InputDefinition("obKostki", "Ankle circumference"),
				new InputDefinition("obLydki", "Calf circumference"),
				new InputDefinition("obPodkolanem", "Lower knee circumference"),
				new InputDefinition("obKolana", "Knee circumference"),
				new InputDefinition("obUda", "Thigh circumference")
			];
			
			var outputDefinitions = [
				new OutputDefinition("zmianaSzer", "Width ratio", function(v) { return v.kSzerProbki / v.pSzerProbki;}, "float"),
				new OutputDefinition("zmianaDl", "Length ratio", function(v) { return v.kDlProbki / v.pDlProbki;}, "float"),
				new OutputDefinition("maxZmianaSzer", "Maximal width ratio", function(v) { return v.maxSzerProbki / v.pSzerProbki;}, "float"),
				new OutputDefinition("pDlGoryStopy", "Calculated upper foot length", function(v) { return v.dlGoryStopy / v.zmianaDl;}, "cm"),
				new OutputDefinition("pDlKostkaLydka", "Calculated ankle to calf length", function(v) { return v.dlKostkaLydka / v.zmianaDl;}, "cm"),
				new OutputDefinition("pDlKolanoPodkolano", "Calculated knee to lower knee length", function(v) { return v.dlKolanoPodkolano / v.zmianaDl;}, "cm"),
				new OutputDefinition("pDlKostkaKolano", "Calculated ankle to knee length", function(v) { return v.dlKostkaKolano / v.zmianaDl;}, "cm"),
				new OutputDefinition("pDlKolanoBrzeg", "Calculated knee to thigh length", function(v) { return v.dlKolanoBrzeg / v.zmianaDl;}, "cm"),
				new OutputDefinition("pObPalcow", "Calculated toes circumference", function(v) { return v.obPalcow / v.zmianaSzer;}, "cm"),
				new OutputDefinition("pObPiety", "Calculated heel circumference", function(v) { return v.obPiety / v.zmianaSzer;}, "cm"),
				new OutputDefinition("pObKostki", "Calculated ankle circumference", function(v) { return Math.max(v.obPiety / v.maxZmianaSzer, v.obKostki / v.zmianaSzer);}, "cm"),
				new OutputDefinition("pObLydki", "Calculated calf circumference", function(v) { return v.obLydki / v.zmianaSzer;}, "cm"),
				new OutputDefinition("pObPodkolanem", "Calculated lower knee circumference", function(v) { return v.obPodkolanem / v.zmianaSzer;}, "cm"),
				new OutputDefinition("pObKolana", "Calculated knee circumference", function(v) { return v.obKolana / v.zmianaSzer;}, "cm"),
				new OutputDefinition("pObUda", "Calculated thigh circumference", function(v) { return v.obUda / v.zmianaSzer;}, "cm"),
				new OutputDefinition("BD", "BD", function(v) { return v.pDlKolanoBrzeg;}, "cm"),
				new OutputDefinition("DF", "DF", function(v) { return v.pDlKolanoPodkolano;}, "cm"),
				new OutputDefinition("DK", "DK", function(v) { return v.pDlKostkaKolano;}, "cm"),
				new OutputDefinition("HK", "HK", function(v) { return v.pDlKostkaLydka;}, "cm"),
				new OutputDefinition("KO", "KO", function(v) { return v.pDlGoryStopy;}, "cm"),
				new OutputDefinition("AB", "AB", function(v) { return v.pObUda/2;}, "cm"),
				new OutputDefinition("CD", "CD", function(v) { return v.pObKolana/2;}, "cm"),
				new OutputDefinition("EF", "EF", function(v) { return v.pObPodkolanem/2;}, "cm"),
				new OutputDefinition("GH", "GH", function(v) { return v.pObLydki/2;}, "cm"),
				new OutputDefinition("IK", "IK", function(v) { return v.pObKostki/2;}, "cm"),
				new OutputDefinition("JK", "JK, JM, IL", function(v) { return v.pObPiety/4;}, "cm"),
				new OutputDefinition("IJ", "IJ, LM", function(v) { return v.IK - v.JK;}, "cm"),
				new OutputDefinition("NO", "NO", function(v) { return v.pObPalcow/4;}, "cm"),
				new OutputDefinition("firstEl", "firstElementPlacement", function(v) { return [0, 0];}, "cm", false),
				new OutputDefinition("secondEl", "secondElementPlacement", function(v) { return [v.firstEl[0] + v.AB + 10, v.firstEl[1] + v.pDlKolanoBrzeg + v.pDlKostkaKolano];}, "cm", false)
			];
			
			var previewConfiguration = new PreviewConfiguration([
				new PointDefinition("A", function(v) { return [v.firstEl[0] - v.AB, v.firstEl[1]]}),
				new PointDefinition("B", function(v) { return v.firstEl}),
				new PointDefinition("C", function(v) { return [v.firstEl[0] - v.CD, v.B[1] + v.BD]}),
				new PointDefinition("D", function(v) { return [v.firstEl[0],        v.B[1] + v.BD]}),
				new PointDefinition("E", function(v) { return [v.firstEl[0] - v.EF, v.D[1] + v.DF]}),
				new PointDefinition("F", function(v) { return [v.firstEl[0],        v.D[1] + v.DF]}),
				new PointDefinition("G", function(v) { return [v.firstEl[0] - v.GH, v.D[1] + (v.DK - v.HK)]}),
				new PointDefinition("H", function(v) { return [v.firstEl[0],        v.D[1] + (v.DK - v.HK)]}),
				new PointDefinition("I", function(v) { return [v.firstEl[0] - v.IK, v.H[1] + v.HK]}),
				new PointDefinition("J", function(v) { return [v.firstEl[0] - v.JK, v.H[1] + v.HK]}),
				new PointDefinition("K", function(v) { return [v.firstEl[0],        v.H[1] + v.HK]}),
				new PointDefinition("L", function(v) { return [v.I[0],              v.I[1] + v.JK]}),
				new PointDefinition("M", function(v) { return [v.L[0] + v.IJ,       v.L[1]]}),
				new PointDefinition("N", function(v) { return [v.firstEl[0] - v.NO, v.K[1] + v.KO]}),
				new PointDefinition("O", function(v) { return [v.firstEl[0],        v.K[1] + v.KO]}),
				new PointDefinition("P", function(v) { return [v.secondEl[0] - v.JK, v.secondEl[1]]}),
				new PointDefinition("R", function(v) { return [v.secondEl[0],        v.secondEl[1]]}),
				new PointDefinition("S", function(v) { return [v.secondEl[0] - v.NO, v.secondEl[1] + v.KO]}),
				new PointDefinition("T", function(v) { return [v.secondEl[0],        v.secondEl[1] + v.KO]}),
				new PointDefinition("A'", function(v) { return [v.firstEl[0] + v.AB, v.firstEl[1]]}),
				new PointDefinition("C'", function(v) { return [v.firstEl[0] + v.CD, v.B[1] + v.BD]}),
				new PointDefinition("E'", function(v) { return [v.firstEl[0] + v.EF, v.D[1] + v.DF]}),
				new PointDefinition("G'", function(v) { return [v.firstEl[0] + v.GH, v.D[1] + (v.DK - v.HK)]}),
				new PointDefinition("I'", function(v) { return [v.firstEl[0] + v.IK, v.H[1] + v.HK]}),
				new PointDefinition("J'", function(v) { return [v.firstEl[0] + v.JK, v.H[1] + v.HK]}),
				new PointDefinition("L'", function(v) { return [v["I'"][0],          v.I[1] + v.JK]}),
				new PointDefinition("M'", function(v) { return [v["L'"][0] - v.IJ,   v.L[1]]}),
				new PointDefinition("N'", function(v) { return [v.firstEl[0] + v.NO, v.K[1] + v.KO]}),
				new PointDefinition("P'", function(v) { return [v.secondEl[0] + v.JK, v.secondEl[1]]}),
				new PointDefinition("S'", function(v) { return [v.secondEl[0] + v.NO, v.secondEl[1] + v.KO]}),
			], [
				new PathDefinition(["A", "B", "D", "F", "H", "K", "O", "N", "J", "M", "L", "I", "G", "E", "C", "A"]),
				new PathDefinition(["O", "N'", "J'", "M'", "L'", "I'", "G'", "E'", "C'", "A'", "B"]),
				new PathDefinition(["P", "R", "T", "S"]),
				new PathDefinition(["P'", "R", "T", "S'"])
			]);
			
			var app = new PatternAppTemplate("XVIII century stockings calculator", inputDefinitions, outputDefinitions, previewConfiguration);
			app.mount("stockingsApp");
		</script>
	</body>
</html>